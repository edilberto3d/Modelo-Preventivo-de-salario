<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Predicción de Salario</title>
  <style>
    /* Reset, gradiente y tipografía */
    * { box-sizing: border-box; margin:0; padding:0; }
    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #6B73FF, #000DFF);
      min-height:100vh; display:flex;
      align-items:center; justify-content:center;
      color:#333;
    }
    .form-container {
      background:#fff; padding:2rem;
      border-radius:12px; box-shadow:0 8px 24px rgba(0,0,0,0.2);
      width:100%; max-width:420px;
      animation:fadeIn 0.6s ease-out;
      position:relative;
    }
    h2 {
      text-align:center; margin-bottom:1.5rem;
      color:#000DFF; text-shadow:1px 1px rgba(0,0,0,0.1);
    }
    .form-group { margin-bottom:1rem; position:relative; }
    label { display:block; margin-bottom:0.5rem; font-weight:bold; }
    input, select {
      width:100%; padding:0.75rem; border:1px solid #ccc;
      border-radius:8px; font-size:1rem;
      transition:border-color 0.3s, box-shadow 0.3s;
    }
    input:focus, select:focus {
      border-color:#000DFF; box-shadow:0 0 8px rgba(0,13,255,0.2);
      outline:none;
    }
    .error { border-color:#FF4136 !important; animation:shake 0.3s; }
    .error-message {
      color:#FF4136; font-size:0.85rem;
      position:absolute; top:100%; left:0; margin-top:0.25rem;
      display:none;
    }
    .btn-submit {
      width:100%; padding:0.75rem; background:#000DFF;
      color:#fff; font-size:1.1rem; font-weight:bold;
      border:none; border-radius:8px; cursor:pointer;
      transition:background 0.3s, transform 0.1s;
      margin-top:1.5rem;
    }
    .btn-submit:hover { background:#6B73FF; }
    .btn-submit:active { transform:scale(0.98); }
    .result-box {
      margin-top:1rem; text-align:center;
      font-size:1.3rem; color:#155724;
      padding:0.75rem; border:1px solid #c3e6cb;
      border-radius:8px; background:#d4edda;
      animation:fadeIn 0.5s ease-out; display:none;
    }
    @keyframes fadeIn {
      from { opacity:0; transform:translateY(-10px); }
      to   { opacity:1; transform:translateY(0); }
    }
    @keyframes shake {
      0%,100% { transform:translateX(0); }
      20%,60% { transform:translateX(-5px); }
      40%,80% { transform:translateX(5px); }
    }
    @media(max-width:480px) {
      .form-container { padding:1rem; }
      .btn-submit { font-size:1rem; }
    }
  </style>
</head>
<body>
  <form class="form-container" id="salaryForm" novalidate>
    <h2>Predicción de Salario</h2>

    <div class="form-group">
      <label for="designation">DESIGNATION</label>
      <select id="designation" name="designation" required>
        <option value="">Selecciona tu puesto</option>
        <option>Data Engineer</option>
        <option>Data Scientist</option>
        <option>Machine Learning Engineer</option>
        <option>Business Analyst</option>
      </select>
      <span class="error-message">Por favor selecciona una opción.</span>
    </div>

    <div class="form-group">
      <label for="tenure">TenureDays</label>
      <input type="number" id="tenure" name="tenure" placeholder="Días de antigüedad" required min="0" step="1">
      <span class="error-message">Ingresa un número válido.</span>
    </div>

    <div class="form-group">
      <label for="age">AGE</label>
      <input type="number" id="age" name="age" placeholder="Tu edad" required min="18" max="100" step="1">
      <span class="error-message">Edad entre 18 y 100 años.</span>
    </div>

    <div class="form-group">
      <label for="exp">PAST EXP</label>
      <input type="number" id="exp" name="exp" placeholder="Años de experiencia" required min="0" max="50" step="0.1">
      <span class="error-message">Ingresa años de experiencia válidos.</span>
    </div>

    <div class="form-group">
      <label for="leaves">LEAVES USED</label>
      <input type="number" id="leaves" name="leaves" placeholder="Días de permiso usados" required min="0" step="1">
      <span class="error-message">Ingresa un número válido.</span>
    </div>

    <button type="submit" class="btn-submit" id="submitBtn">Calcular Salario</button>
    <div id="result" class="result-box"></div>
  </form>

  <script>
    const form = document.getElementById('salaryForm');
    const resultDiv = document.getElementById('result');
    const submitBtn = document.getElementById('submitBtn');

    form.addEventListener('submit', async e => {
      e.preventDefault();
      resultDiv.style.display = 'none';
      submitBtn.disabled = true;
      submitBtn.textContent = 'Calculando...';

      let valid = true;
      form.querySelectorAll('select, input').forEach(field => {
        const msg = field.nextElementSibling;
        if (!field.checkValidity()) {
          valid = false;
          field.classList.add('error');
          msg.style.display = 'block';
        } else {
          field.classList.remove('error');
          msg.style.display = 'none';
        }
      });
      if (!valid) {
        submitBtn.disabled = false;
        submitBtn.textContent = 'Calcular Salario';
        return;
      }

      // Monta payload JSON
      const payload = {
        designation: form.designation.value,
        tenure: Number(form.tenure.value),
        age: Number(form.age.value),
        exp: Number(form.exp.value),
        leaves: Number(form.leaves.value)
      };

      try {
        const res = await fetch('/predict', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });
        const json = await res.json();
        if (res.ok) {
          const salario = Number(json.salary).toLocaleString('es-MX');
          resultDiv.textContent = `Salario estimado: $${salario}`;
        } else {
          resultDiv.textContent = `Error: ${json.error}`;
        }
      } catch {
        resultDiv.textContent = 'Error de conexión.';
      }

      resultDiv.style.display = 'block';
      submitBtn.disabled = false;
      submitBtn.textContent = 'Calcular Salario';
    });
  </script>
</body>
</html>

